pass tcp 10.1.1.2 any -> 192.1.1.2 502 (flow:established; content:"|03|"; offset:7; depth:1;content:"|00 03 00 01|"; offset:8; depth:4; flowbits:isnotset,any,modbus;flowbits:setx,s1,modbus; sid:3000000; rev:1; classtype:tcp-connection; priority:10;)
pass tcp 10.1.1.2 any -> 192.1.1.2 502 (flow:established; content:"|01|"; offset:7; depth:1; flowbits:isnotset,any,modbus;flowbits:setx,s2,modbus; sid:3000001; rev:1; classtype:tcp-connection; priority:10;)
pass tcp 10.1.1.2 any -> 192.1.1.2 502 (flow:established; content:"|02|"; offset:7; depth:1; flowbits:isnotset,any,modbus;flowbits:setx,s3,modbus; sid:3000002; rev:1; classtype:tcp-connection; priority:10;)
pass tcp 192.1.1.2 502 -> 10.1.1.2 any (flow:established; content:"|03|"; offset:7; depth:1; flowbits:isset,s1;flowbits:unset,all,modbus; sid:3000003; rev:1; classtype:tcp-connection; priority:10;)
pass tcp 192.1.1.2 502 -> 10.1.1.2 any (flow:established; content:"|01|"; offset:7; depth:1; flowbits:isset,s2;flowbits:unset,all,modbus; sid:3000004; rev:1; classtype:tcp-connection; priority:10;)
pass tcp 192.1.1.2 502 -> 10.1.1.2 any (flow:established; content:"|02|"; offset:7; depth:1; flowbits:isset,s3;flowbits:unset,all,modbus; sid:3000005; rev:1; classtype:tcp-connection; priority:10;)
pass tcp 10.1.1.2 any -> 192.1.1.2 502 (flags:S; sid:3000006; rev:1; classtype:tcp-connection; priority:10;)
pass tcp 192.1.1.2 502 -> 10.1.1.2 any (flags:SA; sid:3000007; rev:1; classtype:tcp-connection; priority:10;)
pass tcp 10.1.1.2 any <> 192.1.1.2 502 (flags:F+; sid:3000008; rev:1; classtype:tcp-connection; priority:10;)
pass tcp 10.1.1.2 any <> 192.1.1.2 502 (flags:A; dsize:0; sid:3000009; rev:1; classtype:tcp-connection; priority:10;)
