pass tcp 192.168.1.192 any -> 192.168.1.100 502 (flow:established; content:"|03|"; offset:7; depth:1;content:"|00 08 00 04|"; offset:8; depth:4; flowbits:isnotset,any,modbus;flowbits:setx,s1,modbus; sid:1000000;)
pass tcp 192.168.1.192 any -> 192.168.1.100 502 (flow:established; content:"|01|"; offset:7; depth:1; flowbits:isnotset,any,modbus;flowbits:setx,s2,modbus; sid:1000001;)
pass tcp 192.168.1.192 any -> 192.168.1.100 502 (flow:established; content:"|02|"; offset:7; depth:1; flowbits:isnotset,any,modbus;flowbits:setx,s3,modbus; sid:1000002;)
pass tcp 192.168.1.100 502 -> 192.168.1.192 any (flow:established; content:"|03|"; offset:7; depth:1; flowbits:isset,s1;flowbits:unset,all,modbus; sid:1000003;)
pass tcp 192.168.1.100 502 -> 192.168.1.192 any (flow:established; content:"|01|"; offset:7; depth:1; flowbits:isset,s2;flowbits:unset,all,modbus; sid:1000004;)
pass tcp 192.168.1.100 502 -> 192.168.1.192 any (flow:established; content:"|02|"; offset:7; depth:1; flowbits:isset,s3;flowbits:unset,all,modbus; sid:1000005;)
pass tcp 192.168.1.192 any -> 192.168.1.100 502 (flags:S; sid:1000006;)
pass tcp 192.168.1.100 502 -> 192.168.1.192 any (flags:SA; sid:1000007;)
pass tcp 192.168.1.192 any <> 192.168.1.100 502 (flags:F+; sid:1000008;)
pass tcp 192.168.1.192 any <> 192.168.1.100 502 (flags:A; dsize:0; sid:1000009;)
drop tcp 192.168.1.192 any <> 192.168.1.100 502 (sid:1000010;)
