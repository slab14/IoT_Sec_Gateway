pass tcp 192.1.1.2 any -> 10.1.1.2 502 (flow:established; content:"|03|"; offset:7; depth:1;content:"|00 03 00 01|"; offset:8; depth:4; flowbits:isnotset,any,modbus;flowbits:setx,s1,modbus; sid:10000000; rev:1; priority:10; msg:"a";)
pass tcp 192.1.1.2 any -> 10.1.1.2 502 (flow:established; content:"|01|"; offset:7; depth:1; flowbits:isnotset,any,modbus;flowbits:setx,s2,modbus; sid:10000001; rev:1; priority:10; msg:"b";)
pass tcp 192.1.1.2 any -> 10.1.1.2 502 (flow:established; content:"|02|"; offset:7; depth:1; flowbits:isnotset,any,modbus;flowbits:setx,s3,modbus; sid:10000002; rev:1; priority:10; msg:"c";)
pass tcp 10.1.1.2 502 -> 192.1.1.2 any (flow:established; content:"|03|"; offset:7; depth:1; flowbits:isset,s1;flowbits:unset,all,modbus; sid:10000003; rev:1; priority:10; msg:"d";)
pass tcp 10.1.1.2 502 -> 192.1.1.2 any (flow:established; content:"|01|"; offset:7; depth:1; flowbits:isset,s2;flowbits:unset,all,modbus; sid:10000004; rev:1; priority:10; msg:"e";)
pass tcp 10.1.1.2 502 -> 192.1.1.2 any (flow:established; content:"|02|"; offset:7; depth:1; flowbits:isset,s3;flowbits:unset,all,modbus; sid:10000005; rev:1; priority:10; msg:"f";)
pass tcp 192.1.1.2 any -> 10.1.1.2 502 (flags:S; sid:10000006; rev:1; priority:10; msg:"SYN";)
pass tcp 10.1.1.2 502 -> 192.1.1.2 any (flags:SA; sid:10000007; rev:1; priority:10; msg:"SYNACK";)
pass tcp 192.1.1.2 any <> 10.1.1.2 502 (flags:F+; sid:10000008; rev:1; priority:10; msg:"FINACK";)
pass tcp 192.1.1.2 any <> 10.1.1.2 502 (msg:"ACK"; flags:A; dsize:0; sid:10000009; rev:1; priority:10;)
drop ip any any <> any any (msg:"Outside of behavioral model"; sid:10000010;)